<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#1a1a1a">
    <meta name="description" content="BowMafia DAO - Join the exclusive community of Bow enthusiasts">
    <meta name="robots" content="index, follow">
    <title>BowMafia - BowDAO</title>
    
    <!-- DNS prefetch for external resources -->
    <link rel="dns-prefetch" href="//fonts.googleapis.com">
    <link rel="dns-prefetch" href="//fonts.gstatic.com">
    
    <!-- Mobile optimization -->
    <meta name="theme-color" content="#b19cd9">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: Arial, sans-serif;
            overflow-x: hidden;
            background-color: #1a1a1a;
        }
        
        .fullscreen-video {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            object-fit: cover;
            z-index: -1;
            background-color: #1a1a1a;
        }

        /* Mobile-specific video styling */
        @media (max-width: 768px) {
            .fullscreen-video {
                width: 100vw;
                height: 100vh;
                object-fit: cover;
                background: #1a1a1a;
            }
        }
        
        .hero {
            position: relative;
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .video-fallback {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            z-index: -2;
        }
        
        .button-container {
            display: flex;
            gap: 2rem;
            z-index: 10;
            position: relative;
            top: 120px;
        }
        
        .left-button, .right-button {
            padding: 1rem 2rem;
            font-size: 1.1rem;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .left-button {
            background: rgba(177, 156, 217, 0.9);
            color: #fff;
        }
        
        .right-button {
            background: rgba(255, 255, 255, 0.9);
            color: #333;
        }
        
        .left-button:hover, .right-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        .hamburger-menu {
            position: fixed;
            top: 1rem;
            right: 1rem;
            z-index: 1000;
        }
        
        .hamburger-btn {
            background: rgba(177, 156, 217, 0.9);
            border: none;
            padding: 0.5rem;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            gap: 3px;
            box-shadow: 0 4px 12px rgba(177, 156, 217, 0.2);
            transition: background 0.3s;
        }

        .hamburger-btn:hover {
            background: #b19cd9;
        }
        
        .hamburger-line {
            width: 25px;
            height: 3px;
            background: #333;
            transition: 0.3s;
        }
        
        .menu-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0, 0, 0, 0.95);
            display: none;
            z-index: 999;
        }
        
        .menu-overlay.active {
            display: flex;
        }
        
        .menu-content {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            width: 100%;
            height: 100%;
            gap: 2rem;
        }
        
        .menu-item {
            display: inline-block;
            background: rgba(177, 156, 217, 0.9);
            color: #fff;
            text-decoration: none;
            font-size: 1.1rem;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            padding: 0.8rem 2rem;
            margin: 0.3rem 0;
            cursor: pointer;
            letter-spacing: 1px;
            text-transform: uppercase;
            box-shadow: 0 2px 8px rgba(177, 156, 217, 0.15);
            transition: background 0.3s, color 0.3s, box-shadow 0.3s;
        }
        
        .menu-item:hover {
            background: #9b7bc7;
            color: #fff;
            box-shadow: 0 4px 16px rgba(177, 156, 217, 0.25);
        }
        
        .about-section {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 1000;
            background: rgba(34, 34, 34, 0.95);
            color: white;
            overflow-y: auto;
        }
        
        .about-content {
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 2rem;
            text-align: center;
        }
        
        .about-content h1 {
            font-size: 2.8rem;
            margin-bottom: 1.2rem;
            letter-spacing: 1px;
        }
        
        .about-content div {
            max-width: 700px;
            width: 90vw;
            padding: 2rem;
            line-height: 1.6;
        }
        
        .about-content p {
            margin-bottom: 1rem;
        }
        
        .about-content h3 {
            margin-top: 2rem;
            font-size: 1.3rem;
            margin-bottom: 1rem;
        }
        
        #about-close {
            margin-top: 2.5rem;
            padding: 0.7em 2em;
            font-size: 1.2em;
            background: #fff;
            color: #222;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.3s ease;
        }
        
        #about-close:hover {
            background: #f0f0f0;
        }
        
        .footer {
            position: fixed;
            bottom: 1rem;
            left: 50%;
            transform: translateX(-50%);
            color: rgba(255, 255, 255, 0.8);
            text-align: center;
            z-index: 10;
            font-size: 0.9rem;
        }
        
        .footer a {
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
        }
        
        .footer a:hover {
            color: white;
        }
        
        .loading-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 1.2rem;
            z-index: 5;
            display: none;
        }
        
        /* Mobile video tap-to-play overlay */
        .video-tap-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(34, 34, 34, 0.3);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1001;
            flex-direction: column;
            cursor: pointer;
        }
        
        .video-tap-text {
            color: white;
            font-size: 1.2rem;
            text-align: center;
            background: rgba(0, 0, 0, 0.7);
            padding: 1rem 2rem;
            border-radius: 8px;
            margin-bottom: 1rem;
        }
        
        .video-play-icon {
            width: 60px;
            height: 60px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: #333;
        }
        
        @media (max-width: 768px) {
            .button-container {
                flex-direction: column;
                gap: 1rem;
            }
            
            .left-button, .right-button {
                padding: 0.8rem 1.5rem;
                font-size: 1rem;
            }
            
            .about-content h1 {
                font-size: 2rem;
            }
            
            .about-content div {
                padding: 1rem;
            }
        }

        /* Join Community Button */
        .join-community-btn {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            z-index: 100;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            background: none;
            padding: 0;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .join-community-btn:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }
        
        .join-community-btn:active {
            transform: translateY(0) scale(1.02);
        }
        
        .join-community-video {
            width: 150px;
            height: auto;
            display: block;
            border-radius: 8px;
        }
        
        /* Mobile responsive for join community button */
        @media (max-width: 768px) {
            .join-community-btn {
                bottom: 4rem;
                right: 1rem;
            }
            
            .join-community-video {
                width: 80px;
            }
        }
        
        @media (max-width: 480px) {
            .join-community-btn {
                bottom: 4rem;
                right: 0.5rem;
            }
            
            .join-community-video {
                width: 70px;
            }
        }

        /* Debug info */
        .debug-info {
            position: fixed;
            top: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px;
            font-size: 12px;
            z-index: 2000;
            display: none;
            max-height: 200px;
            overflow-y: auto;
            width: 300px;
        }
    </style>
</head>
<body>
    <!-- Debug info -->
    <div class="debug-info" id="debug-info"></div>
    
    <!-- Video fallback background -->
    <div class="video-fallback"></div>
    
    <!-- Loading message -->
    <div class="loading-message" id="loading-message">Loading video...</div>
    
    <!-- Mobile tap to play overlay -->
    <div class="video-tap-overlay" id="video-tap-overlay">
        <div class="video-tap-text">Tap to play video</div>
        <div class="video-play-icon">▶</div>
    </div>
    
    <!-- Hamburger Menu -->
    <div class="hamburger-menu">
        <button class="hamburger-btn" id="hamburger-btn">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
        </button>
        <nav class="menu-overlay" id="menu-overlay">
            <div class="menu-content">
                <a href="assets.html" class="menu-item">ASSETS</a>
                <a href="popouts.html" class="menu-item">BOW X BOB</a>
                <a href="#about" class="menu-item" id="about-link">ABOUT US</a>
            </div>
        </nav>
    </div>

    <main>
        <section id="home" class="hero">
            <!-- Main background video -->
            <video 
                class="fullscreen-video" 
                id="main-video" 
                muted 
                loop 
                playsinline 
                webkit-playsinline
                preload="metadata">
                Your browser does not support the video tag.
            </video>
            
            <div class="button-container">
                <button class="left-button" onclick="window.location.href='dao.html'">Join the DAO</button>
                <button class="right-button" onclick="window.location.href='shop.html'">Silk & Bows</button>
            </div>
            
            <!-- Join Community Button -->
            <button class="join-community-btn" onclick="window.open('https://www.doginaldogs.com/join-the-community', '_blank')">
                <video class="join-community-video" autoplay muted loop playsinline>
                    <source src="assets/images/jointhecommunity.mp4" type="video/mp4">
                    <!-- Fallback image if video fails -->
                    <img src="assets/images/jointhecommunity.png" alt="Join the Community" style="width: 150px; height: auto; border-radius: 8px;">
                </video>
            </button>
        </section>
        
        <!-- About Us Section -->
        <section id="about" class="about-section">
            <video class="fullscreen-video" id="about-video" muted loop playsinline preload="none">
                <source src="assets/videos/bowmafiadao.mp4" type="video/mp4">
                Your browser does not support the video tag.
            </video>
            <div class="about-content">
                <h1>About Us</h1>
                <div>
                    <p>Welcome to the Bow Mafia, home of the Bow DAO — a decentralized community built around passion, purpose, and the power of the Doginal Dogs.</p>
                    <p>We're not just another DAO. We're a movement focused on elevating one of the most iconic traits in the Doginals universe: the Bow Dog. These rare and expressive collectibles are at the heart of our mission — and we're here to raise their floor, build meaningful utility, and unlock real value for holders and contributors alike.</p>
                    <p>But you don't need to own a Bow Dog to be part of the family. The Bow Mafia is open to anyone who wants to support the Doginal ecosystem, contribute ideas, and help build something bigger than themselves. Whether you're an artist, developer, collector, or simply a DOGE enthusiast — there's a place for you here.</p>
                    <h3>Powered by Community</h3>
                    <p>Bow DAO is 100% community-led. That means decisions are made by the members — not a centralized team. Got an idea? Share it. Want to launch a new project? Pitch it. Proposals are discussed openly in our DAO channels, and votes happen transparently. While Bow Dog holders may hold more sway in future decisions, every voice matters.</p>
                </div>
                <button id="about-close">Close</button>
            </div>
        </section>
    </main>
    
    <!-- Footer -->
    <footer class="footer" id="main-footer">
        BowMafiaDAO © 2025 | <a href="#terms">Terms & Conditions</a>
    </footer>

    <script>
        // Debug toggle (press 'd' key to show/hide debug info)
        let debugMode = false;
        document.addEventListener('keydown', function(e) {
            if (e.key === 'd' || e.key === 'D') {
                debugMode = !debugMode;
                const debugInfo = document.getElementById('debug-info');
                debugInfo.style.display = debugMode ? 'block' : 'none';
            }
        });

        function updateDebugInfo(message) {
            if (debugMode) {
                const debugInfo = document.getElementById('debug-info');
                const timestamp = new Date().toLocaleTimeString();
                debugInfo.innerHTML += `<div>${timestamp}: ${message}</div>`;
                debugInfo.scrollTop = debugInfo.scrollHeight;
            }
            console.log(message);
        }

        // Enhanced mobile detection
        function isMobileDevice() {
            const userAgent = navigator.userAgent.toLowerCase();
            const mobileKeywords = ['android', 'webos', 'iphone', 'ipad', 'ipod', 'blackberry', 'windows phone', 'mobile'];
            const isMobileUA = mobileKeywords.some(keyword => userAgent.includes(keyword));
            const isTouchDevice = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
            const isSmallScreen = window.innerWidth <= 768;
            
            const result = isMobileUA || (isTouchDevice && isSmallScreen);
            updateDebugInfo(`Mobile detection - UA: ${isMobileUA}, Touch: ${isTouchDevice}, Small: ${isSmallScreen}, UserAgent: ${navigator.userAgent}, Result: ${result}`);
            return result;
        }

        function isAndroidDevice() {
            const userAgent = navigator.userAgent.toLowerCase();
            const isAndroid = userAgent.includes('android');
            updateDebugInfo(`Android detection: ${isAndroid}`);
            return isAndroid;
        }

        // Get DOM elements
        const mainVideo = document.getElementById('main-video');
        const aboutVideo = document.getElementById('about-video');
        const loadingMessage = document.getElementById('loading-message');
        const videoTapOverlay = document.getElementById('video-tap-overlay');

        let videoInitialized = false;
        let isVideoPlaying = false;
        let userHasInteracted = false;

        // Video file paths
        const videoSources = {
            desktop: 'assets/videos/bowmafiadao.mp4',
            mobile: 'assets/videos/bmdmobile.mp4',
            mobileFallback: 'assets/videos/bowmafiadaomobile.mp4'
        };

        // Check if video file exists
        async function checkVideoExists(url) {
            try {
                const response = await fetch(url, { method: 'HEAD' });
                const exists = response.ok;
                updateDebugInfo(`Video check for ${url}: ${exists ? 'EXISTS' : 'NOT FOUND'}`);
                return exists;
            } catch (error) {
                updateDebugInfo(`Video check failed for ${url}: ${error.message}`);
                return false;
            }
        }

        // Set video source
        async function setVideoSource(isMobile) {
            updateDebugInfo(`Setting video source for ${isMobile ? 'mobile' : 'desktop'}`);
            
            // Clear existing sources
            mainVideo.innerHTML = '';
            
            let videoSrc = '';
            
            if (isMobile) {
                // Try bmdmobile.mp4 first
                const bmdExists = await checkVideoExists(videoSources.mobile);
                if (bmdExists) {
                    videoSrc = videoSources.mobile;
                    updateDebugInfo('Using bmdmobile.mp4 for mobile');
                } else {
                    // Fallback to bowmafiadaomobile.mp4
                    const mobileExists = await checkVideoExists(videoSources.mobileFallback);
                    if (mobileExists) {
                        videoSrc = videoSources.mobileFallback;
                        updateDebugInfo('Using bowmafiadaomobile.mp4 as mobile fallback');
                    } else {
                        // Last resort: desktop video
                        videoSrc = videoSources.desktop;
                        updateDebugInfo('Using desktop video as final mobile fallback');
                    }
                }
            } else {
                // Desktop
                videoSrc = videoSources.desktop;
                updateDebugInfo('Using bowmafiadao.mp4 for desktop');
            }

            // Add source element
            const sourceElement = document.createElement('source');
            sourceElement.src = videoSrc;
            sourceElement.type = 'video/mp4';
            mainVideo.appendChild(sourceElement);
            
            // Add fallback text
            mainVideo.appendChild(document.createTextNode('Your browser does not support the video tag.'));
            
            updateDebugInfo(`Final video source set to: ${videoSrc}`);
            return videoSrc;
        }

        // Try to play video
        async function tryPlayVideo() {
            if (isVideoPlaying) {
                updateDebugInfo('Video already playing, skipping');
                return;
            }

            try {
                updateDebugInfo('Attempting to play video...');
                await mainVideo.play();
                updateDebugInfo('Video play successful!');
                isVideoPlaying = true;
                videoTapOverlay.style.display = 'none';
                loadingMessage.style.display = 'none';
            } catch (error) {
                updateDebugInfo(`Video play failed: ${error.name} - ${error.message}`);
                
                if (isMobileDevice() && !userHasInteracted) {
                    updateDebugInfo('Showing tap overlay for mobile user interaction');
                    videoTapOverlay.style.display = 'flex';
                    loadingMessage.style.display = 'none';
                } else {
                    updateDebugInfo('Video play failed - hiding loading message');
                    loadingMessage.style.display = 'none';
                    videoTapOverlay.style.display = 'none';
                }
            }
        }

        // Handle user interaction
        function handleUserInteraction() {
            updateDebugInfo('User interaction detected');
            userHasInteracted = true;
            videoTapOverlay.style.display = 'none';
            tryPlayVideo();
        }

        // Initialize video
        async function initializeVideo() {
            updateDebugInfo('Starting video initialization...');
            loadingMessage.style.display = 'block';

            const isMobile = isMobileDevice();
            const isAndroid = isAndroidDevice();
            
            // Set video source
            const videoSrc = await setVideoSource(isMobile);

            // Configure video element
            mainVideo.muted = true;
            mainVideo.loop = true;
            mainVideo.setAttribute('playsinline', 'true');
            mainVideo.setAttribute('webkit-playsinline', 'true');
            mainVideo.controls = false;

            // For Android, don't set autoplay at all
            if (!isAndroid) {
                mainVideo.setAttribute('autoplay', 'true');
                updateDebugInfo('Autoplay enabled (not Android)');
            } else {
                updateDebugInfo('Autoplay disabled for Android');
            }

            // Set up event listeners
            mainVideo.addEventListener('loadeddata', function() {
                updateDebugInfo('Video loadeddata event fired');
                loadingMessage.style.display = 'none';
                
                // Try to play after a short delay
                setTimeout(() => {
                    tryPlayVideo();
                }, 100);
            });

            mainVideo.addEventListener('canplay', function() {
                updateDebugInfo('Video canplay event fired');
                
                // Try to play again
                setTimeout(() => {
                    tryPlayVideo();
                }, 100);
            });

            mainVideo.addEventListener('playing', function() {
                updateDebugInfo('Video is now playing');
                isVideoPlaying = true;
                videoTapOverlay.style.display = 'none';
                loadingMessage.style.display = 'none';
            });

            mainVideo.addEventListener('pause', function() {
                updateDebugInfo('Video paused');
                isVideoPlaying = false;
            });

            mainVideo.addEventListener('error', function(e) {
                const error = mainVideo.error;
                const errorMessage = error ? `Code: ${error.code}, Message: ${error.message || 'Unknown'}` : 'Unknown error';
                updateDebugInfo(`Video error: ${errorMessage}`);
                
                loadingMessage.textContent = 'Video unavailable - showing background';
                setTimeout(() => {
                    loadingMessage.style.display = 'none';
                    videoTapOverlay.style.display = 'none';
                }, 3000);
            });

            // Load the video
            mainVideo.load();

            videoInitialized = true;
            updateDebugInfo('Video initialization complete');
        }

        // Set up tap overlay handler
        if (videoTapOverlay) {
            videoTapOverlay.addEventListener('click', handleUserInteraction);
            videoTapOverlay.addEventListener('touchstart', handleUserInteraction);
        }

        // Set up document interaction handlers for fallback
        document.addEventListener('click', function() {
            if (!userHasInteracted && !isVideoPlaying) {
                handleUserInteraction();
            }
        }, { once: true });

        document.addEventListener('touchstart', function() {
            if (!userHasInteracted && !isVideoPlaying) {
                handleUserInteraction();
            }
        }, { once: true });

        // Hamburger menu functionality
        const hamburgerBtn = document.getElementById('hamburger-btn');
        const menuOverlay = document.getElementById('menu-overlay');
        
        if (hamburgerBtn && menuOverlay) {
            hamburgerBtn.addEventListener('click', function() {
                menuOverlay.classList.toggle('active');
            });
            
            menuOverlay.addEventListener('click', function(e) {
                if (e.target === menuOverlay) {
                    menuOverlay.classList.remove('active');
                }
            });
        }
        
        // About Us functionality
        const aboutLink = document.getElementById('about-link');
        const aboutClose = document.getElementById('about-close');
        const homeSection = document.getElementById('home');
        const aboutSection = document.getElementById('about');
        const mainFooter = document.getElementById('main-footer');
        
        if (aboutLink) {
            aboutLink.addEventListener('click', function(e) {
                e.preventDefault();
                homeSection.style.display = 'none';
                aboutSection.style.display = 'block';
                mainFooter.style.display = 'none';
                menuOverlay.classList.remove('active');
                
                // Start about video
                aboutVideo.play().catch(error => {
                    updateDebugInfo(`About video play failed: ${error.message}`);
                });
            });
        }
        
        if (aboutClose) {
            aboutClose.addEventListener('click', function() {
                aboutSection.style.display = 'none';
                homeSection.style.display = '';
                mainFooter.style.display = '';
                aboutVideo.pause();
            });
        }
        
        // Close menu when menu items are clicked
        document.querySelectorAll('.menu-item').forEach(item => {
            item.addEventListener('click', function() {
                menuOverlay.classList.remove('active');
            });
        });

        // Initialize everything when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            updateDebugInfo('DOM loaded, initializing...');
            setTimeout(initializeVideo, 500);
        });

        // Fallback initialization
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeVideo);
        } else {
            updateDebugInfo('DOM already loaded, initializing immediately');
            setTimeout(initializeVideo, 500);
        }
    </script>
</body>
</html>